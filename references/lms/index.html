<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://rentruewang.github.io/bocoel/references/lms/ rel=canonical><link href=../adaptors/ rel=prev><link href=../optimizers/ rel=next><link rel=icon href=../../assets/logo.svg><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.5.21"><title>Language Models - Bayesian Optimization as a Coverage Tool for Evaluating LLM</title><link rel=stylesheet href=../../assets/stylesheets/main.66ac8b77.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_mkdocstrings.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><meta property=og:type content=website><meta property=og:title content="Language Models - Bayesian Optimization as a Coverage Tool for Evaluating LLM"><meta property=og:description content=None><meta property=og:image content=https://rentruewang.github.io/bocoel/assets/images/social/references/lms.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta content=https://rentruewang.github.io/bocoel/references/lms/ property=og:url><meta name=twitter:card content=summary_large_image><meta name=twitter:title content="Language Models - Bayesian Optimization as a Coverage Tool for Evaluating LLM"><meta name=twitter:description content=None><meta name=twitter:image content=https://rentruewang.github.io/bocoel/assets/images/social/references/lms.png></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#language-models class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Bayesian Optimization as a Coverage Tool for Evaluating LLM" class="md-header__button md-logo" aria-label="Bayesian Optimization as a Coverage Tool for Evaluating LLM" data-md-component=logo> <img src=../../assets/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Bayesian Optimization as a Coverage Tool for Evaluating LLM </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Language Models </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/rentruewang/bocoel title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z"/></svg> </div> <div class=md-source__repository> rentruewang/bocoel </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../overview/ class=md-tabs__link> Reference </a> </li> <li class=md-tabs__item> <a href=../../thanks/ class=md-tabs__link> Contributing </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Bayesian Optimization as a Coverage Tool for Evaluating LLM" class="md-nav__button md-logo" aria-label="Bayesian Optimization as a Coverage Tool for Evaluating LLM" data-md-component=logo> <img src=../../assets/logo.svg alt=logo> </a> Bayesian Optimization as a Coverage Tool for Evaluating LLM </label> <div class=md-nav__source> <a href=https://github.com/rentruewang/bocoel title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z"/></svg> </div> <div class=md-source__repository> rentruewang/bocoel </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex=0> <span class=md-ellipsis> Home </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> README </span> </a> </li> <li class=md-nav__item> <a href=../../research/ class=md-nav__link> <span class=md-ellipsis> Research </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../factories/ class=md-nav__link> <span class=md-ellipsis> Factories </span> </a> </li> <li class=md-nav__item> <a href=../storages/ class=md-nav__link> <span class=md-ellipsis> Storages </span> </a> </li> <li class=md-nav__item> <a href=../indices/ class=md-nav__link> <span class=md-ellipsis> Indices </span> </a> </li> <li class=md-nav__item> <a href=../embedders/ class=md-nav__link> <span class=md-ellipsis> Embedders </span> </a> </li> <li class=md-nav__item> <a href=../corpora/ class=md-nav__link> <span class=md-ellipsis> Corpus </span> </a> </li> <li class=md-nav__item> <a href=../scores/ class=md-nav__link> <span class=md-ellipsis> Scores </span> </a> </li> <li class=md-nav__item> <a href=../adaptors/ class=md-nav__link> <span class=md-ellipsis> Adaptors </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Language Models </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Language Models </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#bocoel.GenerativeModel class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;GenerativeModel </span> </a> <nav class=md-nav aria-label= GenerativeModel> <ul class=md-nav__list> <li class=md-nav__item> <a href=#bocoel.GenerativeModel.generate class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;generate </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bocoel.ClassifierModel class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ClassifierModel </span> </a> <nav class=md-nav aria-label= ClassifierModel> <ul class=md-nav__list> <li class=md-nav__item> <a href=#bocoel.ClassifierModel.choices class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;choices </span> </a> </li> <li class=md-nav__item> <a href=#bocoel.ClassifierModel.classify class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;classify </span> </a> </li> <li class=md-nav__item> <a href=#bocoel.ClassifierModel._classify class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;_classify </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bocoel.HuggingfaceCausalLM class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;HuggingfaceCausalLM </span> </a> </li> <li class=md-nav__item> <a href=#bocoel.HuggingfaceGenerativeLM class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;HuggingfaceGenerativeLM </span> </a> </li> <li class=md-nav__item> <a href=#bocoel.HuggingfaceLogitsLM class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;HuggingfaceLogitsLM </span> </a> <nav class=md-nav aria-label= HuggingfaceLogitsLM> <ul class=md-nav__list> <li class=md-nav__item> <a href=#bocoel.HuggingfaceLogitsLM.classify class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;classify </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bocoel.HuggingfaceSequenceLM class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;HuggingfaceSequenceLM </span> </a> <nav class=md-nav aria-label= HuggingfaceSequenceLM> <ul class=md-nav__list> <li class=md-nav__item> <a href=#bocoel.HuggingfaceSequenceLM.classify class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;classify </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bocoel.HuggingfaceTokenizer class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;HuggingfaceTokenizer </span> </a> <nav class=md-nav aria-label= HuggingfaceTokenizer> <ul class=md-nav__list> <li class=md-nav__item> <a href=#bocoel.HuggingfaceTokenizer.to class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to </span> </a> </li> <li class=md-nav__item> <a href=#bocoel.HuggingfaceTokenizer.tokenize class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;tokenize </span> </a> </li> <li class=md-nav__item> <a href=#bocoel.HuggingfaceTokenizer.encode class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;encode </span> </a> </li> <li class=md-nav__item> <a href=#bocoel.HuggingfaceTokenizer.decode class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;decode </span> </a> </li> <li class=md-nav__item> <a href=#bocoel.HuggingfaceTokenizer.batch_decode class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch_decode </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../optimizers/ class=md-nav__link> <span class=md-ellipsis> Optimizers </span> </a> </li> <li class=md-nav__item> <a href=../exams/ class=md-nav__link> <span class=md-ellipsis> Exams </span> </a> </li> <li class=md-nav__item> <a href=../../CHANGELOG/ class=md-nav__link> <span class=md-ellipsis> Changelog </span> </a> </li> <li class=md-nav__item> <a href=../../LICENSE/ class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Contributing </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Contributing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../thanks/ class=md-nav__link> <span class=md-ellipsis> Thank you </span> </a> </li> <li class=md-nav__item> <a href=../../CONTRIBUTING/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> <li class=md-nav__item> <a href=../../CODE_OF_CONDUCT/ class=md-nav__link> <span class=md-ellipsis> Code of Conduct </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#bocoel.GenerativeModel class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;GenerativeModel </span> </a> <nav class=md-nav aria-label= GenerativeModel> <ul class=md-nav__list> <li class=md-nav__item> <a href=#bocoel.GenerativeModel.generate class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;generate </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bocoel.ClassifierModel class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ClassifierModel </span> </a> <nav class=md-nav aria-label= ClassifierModel> <ul class=md-nav__list> <li class=md-nav__item> <a href=#bocoel.ClassifierModel.choices class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;choices </span> </a> </li> <li class=md-nav__item> <a href=#bocoel.ClassifierModel.classify class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;classify </span> </a> </li> <li class=md-nav__item> <a href=#bocoel.ClassifierModel._classify class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;_classify </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bocoel.HuggingfaceCausalLM class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;HuggingfaceCausalLM </span> </a> </li> <li class=md-nav__item> <a href=#bocoel.HuggingfaceGenerativeLM class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;HuggingfaceGenerativeLM </span> </a> </li> <li class=md-nav__item> <a href=#bocoel.HuggingfaceLogitsLM class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;HuggingfaceLogitsLM </span> </a> <nav class=md-nav aria-label= HuggingfaceLogitsLM> <ul class=md-nav__list> <li class=md-nav__item> <a href=#bocoel.HuggingfaceLogitsLM.classify class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;classify </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bocoel.HuggingfaceSequenceLM class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;HuggingfaceSequenceLM </span> </a> <nav class=md-nav aria-label= HuggingfaceSequenceLM> <ul class=md-nav__list> <li class=md-nav__item> <a href=#bocoel.HuggingfaceSequenceLM.classify class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;classify </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bocoel.HuggingfaceTokenizer class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;HuggingfaceTokenizer </span> </a> <nav class=md-nav aria-label= HuggingfaceTokenizer> <ul class=md-nav__list> <li class=md-nav__item> <a href=#bocoel.HuggingfaceTokenizer.to class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to </span> </a> </li> <li class=md-nav__item> <a href=#bocoel.HuggingfaceTokenizer.tokenize class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;tokenize </span> </a> </li> <li class=md-nav__item> <a href=#bocoel.HuggingfaceTokenizer.encode class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;encode </span> </a> </li> <li class=md-nav__item> <a href=#bocoel.HuggingfaceTokenizer.decode class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;decode </span> </a> </li> <li class=md-nav__item> <a href=#bocoel.HuggingfaceTokenizer.batch_decode class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;batch_decode </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=language-models>Language Models</h1> <div class="doc doc-object doc-class"> <h2 id=bocoel.GenerativeModel class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">bocoel.GenerativeModel</span> </h2> <div class="doc doc-contents first"> <p class="doc doc-class-bases"> Bases: <code><span title="typing.Protocol">Protocol</span></code></p> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=bocoel.GenerativeModel.generate class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">generate</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=n>generate</span><span class=p>(</span><span class=n>prompts</span><span class=p>:</span> <span class=n><span title="collections.abc.Sequence">Sequence</span></span><span class=p>[</span><span class=n>str</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n><span title="collections.abc.Sequence">Sequence</span></span><span class=p>[</span><span class=n>str</span><span class=p>]</span>
</code></pre></div> <div class="doc doc-contents "> <details class=todo open> <summary>TODO</summary> <p>Add logits.</p> </details> <p>Generate a sequence of responses given prompts. The length of the response is the same as the prompt. The response would be a continuation of the prompt, and the prompts would be the prefix of the response.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>prompts</code></td> <td> <code><span title="collections.abc.Sequence">Sequence</span>[str]</code> </td> <td> <div class=doc-md-description> <p>The prompts to generate.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title="collections.abc.Sequence">Sequence</span>[str]</code> </td> <td> <div class=doc-md-description> <p>The generated responses. The length must be the same as the prompts.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/bocoel/models/lms/interfaces/generative.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@abc</span><span class=o>.</span><span class=n>abstractmethod</span>
<span class=k>def</span> <span class=nf>generate</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>prompts</span><span class=p>:</span> <span class=n>Sequence</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=o>/</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Sequence</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    TODO:</span>
<span class=sd>        Add logits.</span>

<span class=sd>    Generate a sequence of responses given prompts.</span>
<span class=sd>    The length of the response is the same as the prompt.</span>
<span class=sd>    The response would be a continuation of the prompt,</span>
<span class=sd>    and the prompts would be the prefix of the response.</span>

<span class=sd>    Parameters:</span>
<span class=sd>        prompts: The prompts to generate.</span>

<span class=sd>    Returns:</span>
<span class=sd>        The generated responses. The length must be the same as the prompts.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=o>...</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=bocoel.ClassifierModel class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">bocoel.ClassifierModel</span> </h2> <div class="doc doc-contents first"> <p class="doc doc-class-bases"> Bases: <code><span title="typing.Protocol">Protocol</span></code></p> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h3 id=bocoel.ClassifierModel.choices class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code> <span class="doc doc-object-name doc-attribute-name">choices</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=n>choices</span><span class=p>:</span> <span class=n><span title="collections.abc.Sequence">Sequence</span></span><span class=p>[</span><span class=n>str</span><span class=p>]</span>
</code></pre></div> <div class="doc doc-contents "> <p>The choices for this language model.</p> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title="collections.abc.Sequence">Sequence</span>[str]</code> </td> <td> <div class=doc-md-description> <p>The choices for this language model.</p> </div> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h3 id=bocoel.ClassifierModel.classify class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">classify</span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=n>classify</span><span class=p>(</span><span class=n>prompts</span><span class=p>:</span> <span class=n><span title="collections.abc.Sequence">Sequence</span></span><span class=p>[</span><span class=n>str</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n><span title="numpy.typing.NDArray">NDArray</span></span>
</code></pre></div> <div class="doc doc-contents "> <p>Classify the given prompts.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>prompts</code></td> <td> <code><span title="collections.abc.Sequence">Sequence</span>[str]</code> </td> <td> <div class=doc-md-description> <p>The prompts to classify.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title="numpy.typing.NDArray">NDArray</span></code> </td> <td> <div class=doc-md-description> <p>The logits for each prompt and choice.</p> </div> </td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code>ValueError</code> </td> <td> <div class=doc-md-description> <p>If the shape of the logits is not [len(prompts), len(choices)].</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/bocoel/models/lms/interfaces/classifiers.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>classify</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>prompts</span><span class=p>:</span> <span class=n>Sequence</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=o>/</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Classify the given prompts.</span>

<span class=sd>    Parameters:</span>
<span class=sd>        prompts: The prompts to classify.</span>

<span class=sd>    Returns:</span>
<span class=sd>        The logits for each prompt and choice.</span>

<span class=sd>    Raises:</span>
<span class=sd>        ValueError: If the shape of the logits is not [len(prompts), len(choices)].</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>classified</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_classify</span><span class=p>(</span><span class=n>prompts</span><span class=p>)</span>

    <span class=k>if</span> <span class=nb>list</span><span class=p>(</span><span class=n>classified</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span> <span class=o>!=</span> <span class=p>[</span><span class=nb>len</span><span class=p>(</span><span class=n>prompts</span><span class=p>),</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>choices</span><span class=p>)]:</span>
        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
            <span class=sa>f</span><span class=s2>&quot;Expected logits to have shape </span><span class=si>{</span><span class=p>[</span><span class=nb>len</span><span class=p>(</span><span class=n>prompts</span><span class=p>),</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>choices</span><span class=p>)]</span><span class=si>}</span><span class=s2>, &quot;</span>
            <span class=sa>f</span><span class=s2>&quot;but got </span><span class=si>{</span><span class=n>classified</span><span class=o>.</span><span class=n>shape</span><span class=si>}</span><span class=s2>&quot;</span>
        <span class=p>)</span>

    <span class=k>return</span> <span class=n>classified</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=bocoel.ClassifierModel._classify class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">_classify</span> <span class="doc doc-labels"> <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small> </span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=n>_classify</span><span class=p>(</span><span class=n>prompts</span><span class=p>:</span> <span class=n><span title="collections.abc.Sequence">Sequence</span></span><span class=p>[</span><span class=n>str</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n><span title="numpy.typing.NDArray">NDArray</span></span>
</code></pre></div> <div class="doc doc-contents "> <p>Generate logits given prompts.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>prompts</code></td> <td> <code><span title="collections.abc.Sequence">Sequence</span>[str]</code> </td> <td> <div class=doc-md-description> <p>The prompts to classify.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title="numpy.typing.NDArray">NDArray</span></code> </td> <td> <div class=doc-md-description> <p>The logits for each prompt and choice.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/bocoel/models/lms/interfaces/classifiers.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@abc</span><span class=o>.</span><span class=n>abstractmethod</span>
<span class=k>def</span> <span class=nf>_classify</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>prompts</span><span class=p>:</span> <span class=n>Sequence</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=o>/</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Generate logits given prompts.</span>

<span class=sd>    Parameters:</span>
<span class=sd>        prompts: The prompts to classify.</span>

<span class=sd>    Returns:</span>
<span class=sd>        The logits for each prompt and choice.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=o>...</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=bocoel.HuggingfaceCausalLM class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">bocoel.HuggingfaceCausalLM</span> </h2> <div class="doc-signature highlight"><pre><span></span><code><span class=n>HuggingfaceCausalLM</span><span class=p>(</span>
    <span class=n>model_path</span><span class=p>:</span> <span class=n>str</span><span class=p>,</span> <span class=n>batch_size</span><span class=p>:</span> <span class=n>int</span><span class=p>,</span> <span class=n>device</span><span class=p>:</span> <span class=n>str</span><span class=p>,</span> <span class=n>add_sep_token</span><span class=p>:</span> <span class=n>bool</span> <span class=o>=</span> <span class=kc>False</span>
<span class=p>)</span>
</code></pre></div> <div class="doc doc-contents first"> <p>The Huggingface implementation of language model. This is a wrapper around the Huggingface library, which would try to pull the model from the huggingface hub.</p> <details class=fixme open> <summary>FIXME</summary> <p><code>add_sep_token</code> might cause huggingface to bug out with index out of range. Still unclear how this might occur as <code>[SEP]</code> is a special token.</p> </details> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>model_path</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The path to the model.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr> <td><code>batch_size</code></td> <td> <code>int</code> </td> <td> <div class=doc-md-description> <p>The batch size to use.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr> <td><code>device</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The device to use.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr> <td><code>add_sep_token</code></td> <td> <code>bool</code> </td> <td> <div class=doc-md-description> <p>Whether to add the sep token.</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/bocoel/models/lms/huggingface/causal.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span> <span class=n>model_path</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>batch_size</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>device</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>add_sep_token</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Parameters:</span>
<span class=sd>        model_path: The path to the model.</span>
<span class=sd>        batch_size: The batch size to use.</span>
<span class=sd>        device: The device to use.</span>
<span class=sd>        add_sep_token: Whether to add the sep token.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=c1># Optional dependency.</span>
    <span class=kn>from</span> <span class=nn>transformers</span> <span class=kn>import</span> <span class=n>AutoModelForCausalLM</span>

    <span class=bp>self</span><span class=o>.</span><span class=n>_model_path</span> <span class=o>=</span> <span class=n>model_path</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_tokenizer</span> <span class=o>=</span> <span class=n>HuggingfaceTokenizer</span><span class=p>(</span>
        <span class=n>model_path</span><span class=o>=</span><span class=n>model_path</span><span class=p>,</span> <span class=n>device</span><span class=o>=</span><span class=n>device</span><span class=p>,</span> <span class=n>add_sep_token</span><span class=o>=</span><span class=n>add_sep_token</span>
    <span class=p>)</span>

    <span class=c1># Model used for generation</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_model</span> <span class=o>=</span> <span class=n>AutoModelForCausalLM</span><span class=o>.</span><span class=n>from_pretrained</span><span class=p>(</span><span class=n>model_path</span><span class=p>)</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_model</span><span class=o>.</span><span class=n>pad_token</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tokenizer</span><span class=o>.</span><span class=n>pad_token</span>

    <span class=bp>self</span><span class=o>.</span><span class=n>_batch_size</span> <span class=o>=</span> <span class=n>batch_size</span>

    <span class=bp>self</span><span class=o>.</span><span class=n>to</span><span class=p>(</span><span class=n>device</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=bocoel.HuggingfaceGenerativeLM class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">bocoel.HuggingfaceGenerativeLM</span> </h2> <div class="doc-signature highlight"><pre><span></span><code><span class=n>HuggingfaceGenerativeLM</span><span class=p>(</span>
    <span class=n>model_path</span><span class=p>:</span> <span class=n>str</span><span class=p>,</span> <span class=n>batch_size</span><span class=p>:</span> <span class=n>int</span><span class=p>,</span> <span class=n>device</span><span class=p>:</span> <span class=n>str</span><span class=p>,</span> <span class=n>add_sep_token</span><span class=p>:</span> <span class=n>bool</span> <span class=o>=</span> <span class=kc>False</span>
<span class=p>)</span>
</code></pre></div> <div class="doc doc-contents first"> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="bocoel.models.lms.huggingface.causal.HuggingfaceCausalLM" href="#bocoel.HuggingfaceCausalLM">HuggingfaceCausalLM</a></code>, <code><a class="autorefs autorefs-internal" title="bocoel.models.lms.interfaces.GenerativeModel" href="#bocoel.GenerativeModel">GenerativeModel</a></code></p> <p>The generative model backed by huggingface's transformers library.</p> <p>Since huggingface's tokenizer needs padding to the left to work, padding doesn't guarentee the same positional embeddings, and thus, results. If sameness with generating one by one is desired, batch size should be 1.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>model_path</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The path to the model.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr> <td><code>batch_size</code></td> <td> <code>int</code> </td> <td> <div class=doc-md-description> <p>The batch size to use.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr> <td><code>device</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The device to use.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr> <td><code>add_sep_token</code></td> <td> <code>bool</code> </td> <td> <div class=doc-md-description> <p>Whether to add the sep token.</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/bocoel/models/lms/huggingface/generative.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span> <span class=n>model_path</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>batch_size</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>device</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>add_sep_token</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Parameters:</span>
<span class=sd>        model_path: The path to the model.</span>
<span class=sd>        batch_size: The batch size to use.</span>
<span class=sd>        device: The device to use.</span>
<span class=sd>        add_sep_token: Whether to add the sep token.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span>
        <span class=n>model_path</span><span class=o>=</span><span class=n>model_path</span><span class=p>,</span>
        <span class=n>batch_size</span><span class=o>=</span><span class=n>batch_size</span><span class=p>,</span>
        <span class=n>device</span><span class=o>=</span><span class=n>device</span><span class=p>,</span>
        <span class=n>add_sep_token</span><span class=o>=</span><span class=n>add_sep_token</span><span class=p>,</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=bocoel.HuggingfaceLogitsLM class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">bocoel.HuggingfaceLogitsLM</span> </h2> <div class="doc-signature highlight"><pre><span></span><code><span class=n>HuggingfaceLogitsLM</span><span class=p>(</span>
    <span class=n>model_path</span><span class=p>:</span> <span class=n>str</span><span class=p>,</span>
    <span class=n>batch_size</span><span class=p>:</span> <span class=n>int</span><span class=p>,</span>
    <span class=n>device</span><span class=p>:</span> <span class=n>str</span><span class=p>,</span>
    <span class=n>choices</span><span class=p>:</span> <span class=n><span title="collections.abc.Sequence">Sequence</span></span><span class=p>[</span><span class=n>str</span><span class=p>],</span>
    <span class=n>add_sep_token</span><span class=p>:</span> <span class=n>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<span class=p>)</span>
</code></pre></div> <div class="doc doc-contents first"> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="bocoel.models.lms.huggingface.causal.HuggingfaceCausalLM" href="#bocoel.HuggingfaceCausalLM">HuggingfaceCausalLM</a></code>, <code><a class="autorefs autorefs-internal" title="bocoel.models.lms.interfaces.ClassifierModel" href="#bocoel.ClassifierModel">ClassifierModel</a></code></p> <p>Logits classification model backed by huggingface's transformers library. This means that the model would use the logits of ['1', '2', '3', '4', '5'] as the output, if <code>choices = 5</code>, for the current batch of inputs.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>model_path</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The path to the model.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr> <td><code>batch_size</code></td> <td> <code>int</code> </td> <td> <div class=doc-md-description> <p>The batch size to use.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr> <td><code>device</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The device to use.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr> <td><code>choices</code></td> <td> <code><span title="collections.abc.Sequence">Sequence</span>[str]</code> </td> <td> <div class=doc-md-description> <p>The choices to classify.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr> <td><code>add_sep_token</code></td> <td> <code>bool</code> </td> <td> <div class=doc-md-description> <p>Whether to add the sep token.</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/bocoel/models/lms/huggingface/logits.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span>
    <span class=n>model_path</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
    <span class=n>batch_size</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
    <span class=n>device</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
    <span class=n>choices</span><span class=p>:</span> <span class=n>Sequence</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span>
    <span class=n>add_sep_token</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Parameters:</span>
<span class=sd>        model_path: The path to the model.</span>
<span class=sd>        batch_size: The batch size to use.</span>
<span class=sd>        device: The device to use.</span>
<span class=sd>        choices: The choices to classify.</span>
<span class=sd>        add_sep_token: Whether to add the sep token.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span>
        <span class=n>model_path</span><span class=o>=</span><span class=n>model_path</span><span class=p>,</span>
        <span class=n>batch_size</span><span class=o>=</span><span class=n>batch_size</span><span class=p>,</span>
        <span class=n>device</span><span class=o>=</span><span class=n>device</span><span class=p>,</span>
        <span class=n>add_sep_token</span><span class=o>=</span><span class=n>add_sep_token</span><span class=p>,</span>
    <span class=p>)</span>

    <span class=bp>self</span><span class=o>.</span><span class=n>_choices</span> <span class=o>=</span> <span class=n>choices</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_encoded_choices</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_encode_tokens</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_choices</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=bocoel.HuggingfaceLogitsLM.classify class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">classify</span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=n>classify</span><span class=p>(</span><span class=n>prompts</span><span class=p>:</span> <span class=n><span title="collections.abc.Sequence">Sequence</span></span><span class=p>[</span><span class=n>str</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n><span title="numpy.typing.NDArray">NDArray</span></span>
</code></pre></div> <div class="doc doc-contents "> <p>Classify the given prompts.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>prompts</code></td> <td> <code><span title="collections.abc.Sequence">Sequence</span>[str]</code> </td> <td> <div class=doc-md-description> <p>The prompts to classify.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title="numpy.typing.NDArray">NDArray</span></code> </td> <td> <div class=doc-md-description> <p>The logits for each prompt and choice.</p> </div> </td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code>ValueError</code> </td> <td> <div class=doc-md-description> <p>If the shape of the logits is not [len(prompts), len(choices)].</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/bocoel/models/lms/interfaces/classifiers.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>classify</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>prompts</span><span class=p>:</span> <span class=n>Sequence</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=o>/</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Classify the given prompts.</span>

<span class=sd>    Parameters:</span>
<span class=sd>        prompts: The prompts to classify.</span>

<span class=sd>    Returns:</span>
<span class=sd>        The logits for each prompt and choice.</span>

<span class=sd>    Raises:</span>
<span class=sd>        ValueError: If the shape of the logits is not [len(prompts), len(choices)].</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>classified</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_classify</span><span class=p>(</span><span class=n>prompts</span><span class=p>)</span>

    <span class=k>if</span> <span class=nb>list</span><span class=p>(</span><span class=n>classified</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span> <span class=o>!=</span> <span class=p>[</span><span class=nb>len</span><span class=p>(</span><span class=n>prompts</span><span class=p>),</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>choices</span><span class=p>)]:</span>
        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
            <span class=sa>f</span><span class=s2>&quot;Expected logits to have shape </span><span class=si>{</span><span class=p>[</span><span class=nb>len</span><span class=p>(</span><span class=n>prompts</span><span class=p>),</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>choices</span><span class=p>)]</span><span class=si>}</span><span class=s2>, &quot;</span>
            <span class=sa>f</span><span class=s2>&quot;but got </span><span class=si>{</span><span class=n>classified</span><span class=o>.</span><span class=n>shape</span><span class=si>}</span><span class=s2>&quot;</span>
        <span class=p>)</span>

    <span class=k>return</span> <span class=n>classified</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=bocoel.HuggingfaceSequenceLM class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">bocoel.HuggingfaceSequenceLM</span> </h2> <div class="doc-signature highlight"><pre><span></span><code><span class=n>HuggingfaceSequenceLM</span><span class=p>(</span>
    <span class=n>model_path</span><span class=p>:</span> <span class=n>str</span><span class=p>,</span>
    <span class=n>device</span><span class=p>:</span> <span class=n>str</span><span class=p>,</span>
    <span class=n>choices</span><span class=p>:</span> <span class=n><span title="collections.abc.Sequence">Sequence</span></span><span class=p>[</span><span class=n>str</span><span class=p>],</span>
    <span class=n>add_sep_token</span><span class=p>:</span> <span class=n>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<span class=p>)</span>
</code></pre></div> <div class="doc doc-contents first"> <p class="doc doc-class-bases"> Bases: <code><a class="autorefs autorefs-internal" title="bocoel.models.lms.interfaces.ClassifierModel" href="#bocoel.ClassifierModel">ClassifierModel</a></code></p> <p>The sequence classification model backed by huggingface's transformers library.</p> <details class=quote> <summary>Source code in <code>src/bocoel/models/lms/huggingface/sequences.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span>
    <span class=n>model_path</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
    <span class=n>device</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
    <span class=n>choices</span><span class=p>:</span> <span class=n>Sequence</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span>
    <span class=n>add_sep_token</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
    <span class=c1># Optional dependency</span>
    <span class=kn>from</span> <span class=nn>transformers</span> <span class=kn>import</span> <span class=n>AutoModelForSequenceClassification</span>

    <span class=bp>self</span><span class=o>.</span><span class=n>_model_path</span> <span class=o>=</span> <span class=n>model_path</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_tokenizer</span> <span class=o>=</span> <span class=n>HuggingfaceTokenizer</span><span class=p>(</span>
        <span class=n>model_path</span><span class=o>=</span><span class=n>model_path</span><span class=p>,</span> <span class=n>device</span><span class=o>=</span><span class=n>device</span><span class=p>,</span> <span class=n>add_sep_token</span><span class=o>=</span><span class=n>add_sep_token</span>
    <span class=p>)</span>

    <span class=bp>self</span><span class=o>.</span><span class=n>_choices</span> <span class=o>=</span> <span class=n>choices</span>

    <span class=n>classifier</span> <span class=o>=</span> <span class=n>AutoModelForSequenceClassification</span><span class=o>.</span><span class=n>from_pretrained</span><span class=p>(</span><span class=n>model_path</span><span class=p>)</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_classifier</span> <span class=o>=</span> <span class=n>classifier</span><span class=o>.</span><span class=n>to</span><span class=p>(</span><span class=n>device</span><span class=p>)</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_classifier</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>pad_token_id</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tokenizer</span><span class=o>.</span><span class=n>pad_token_id</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=bocoel.HuggingfaceSequenceLM.classify class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">classify</span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=n>classify</span><span class=p>(</span><span class=n>prompts</span><span class=p>:</span> <span class=n><span title="collections.abc.Sequence">Sequence</span></span><span class=p>[</span><span class=n>str</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n><span title="numpy.typing.NDArray">NDArray</span></span>
</code></pre></div> <div class="doc doc-contents "> <p>Classify the given prompts.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>prompts</code></td> <td> <code><span title="collections.abc.Sequence">Sequence</span>[str]</code> </td> <td> <div class=doc-md-description> <p>The prompts to classify.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title="numpy.typing.NDArray">NDArray</span></code> </td> <td> <div class=doc-md-description> <p>The logits for each prompt and choice.</p> </div> </td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code>ValueError</code> </td> <td> <div class=doc-md-description> <p>If the shape of the logits is not [len(prompts), len(choices)].</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/bocoel/models/lms/interfaces/classifiers.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>classify</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>prompts</span><span class=p>:</span> <span class=n>Sequence</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=o>/</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>NDArray</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Classify the given prompts.</span>

<span class=sd>    Parameters:</span>
<span class=sd>        prompts: The prompts to classify.</span>

<span class=sd>    Returns:</span>
<span class=sd>        The logits for each prompt and choice.</span>

<span class=sd>    Raises:</span>
<span class=sd>        ValueError: If the shape of the logits is not [len(prompts), len(choices)].</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>classified</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_classify</span><span class=p>(</span><span class=n>prompts</span><span class=p>)</span>

    <span class=k>if</span> <span class=nb>list</span><span class=p>(</span><span class=n>classified</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span> <span class=o>!=</span> <span class=p>[</span><span class=nb>len</span><span class=p>(</span><span class=n>prompts</span><span class=p>),</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>choices</span><span class=p>)]:</span>
        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
            <span class=sa>f</span><span class=s2>&quot;Expected logits to have shape </span><span class=si>{</span><span class=p>[</span><span class=nb>len</span><span class=p>(</span><span class=n>prompts</span><span class=p>),</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>choices</span><span class=p>)]</span><span class=si>}</span><span class=s2>, &quot;</span>
            <span class=sa>f</span><span class=s2>&quot;but got </span><span class=si>{</span><span class=n>classified</span><span class=o>.</span><span class=n>shape</span><span class=si>}</span><span class=s2>&quot;</span>
        <span class=p>)</span>

    <span class=k>return</span> <span class=n>classified</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=bocoel.HuggingfaceTokenizer class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-class"></code> <span class="doc doc-object-name doc-class-name">bocoel.HuggingfaceTokenizer</span> </h2> <div class="doc-signature highlight"><pre><span></span><code><span class=n>HuggingfaceTokenizer</span><span class=p>(</span><span class=n>model_path</span><span class=p>:</span> <span class=n>str</span><span class=p>,</span> <span class=n>device</span><span class=p>:</span> <span class=n>str</span><span class=p>,</span> <span class=n>add_sep_token</span><span class=p>:</span> <span class=n>bool</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents first"> <p>A tokenizer for Huggingface models.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>model_path</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The path to the model.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr> <td><code>device</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The device to use.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr> <td><code>add_sep_token</code></td> <td> <code>bool</code> </td> <td> <div class=doc-md-description> <p>Whether to add the sep token.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Raises:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code>ImportError</code> </td> <td> <div class=doc-md-description> <p>If the transformers library is not installed.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/bocoel/models/lms/huggingface/tokenizers.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model_path</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>device</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>add_sep_token</span><span class=p>:</span> <span class=nb>bool</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Parameters:</span>
<span class=sd>        model_path: The path to the model.</span>
<span class=sd>        device: The device to use.</span>
<span class=sd>        add_sep_token: Whether to add the sep token.</span>

<span class=sd>    Raises:</span>
<span class=sd>        ImportError: If the transformers library is not installed.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=c1># Optional dependency.</span>
    <span class=kn>from</span> <span class=nn>transformers</span> <span class=kn>import</span> <span class=n>AutoTokenizer</span>

    <span class=c1># Initializes the tokenizer and pad to the left for sequence generation.</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_tokenizer</span> <span class=o>=</span> <span class=n>AutoTokenizer</span><span class=o>.</span><span class=n>from_pretrained</span><span class=p>(</span>
        <span class=n>model_path</span><span class=p>,</span> <span class=n>padding_side</span><span class=o>=</span><span class=s2>&quot;left&quot;</span><span class=p>,</span> <span class=n>truncation_side</span><span class=o>=</span><span class=s2>&quot;left&quot;</span>
    <span class=p>)</span>

    <span class=c1># Always add the pad token.</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>eos</span> <span class=o>:=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tokenizer</span><span class=o>.</span><span class=n>eos_token</span><span class=p>)</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_tokenizer</span><span class=o>.</span><span class=n>pad_token</span> <span class=o>=</span> <span class=n>eos</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_tokenizer</span><span class=o>.</span><span class=n>add_special_tokens</span><span class=p>({</span><span class=s2>&quot;pad_token&quot;</span><span class=p>:</span> <span class=s2>&quot;[PAD]&quot;</span><span class=p>})</span>

    <span class=k>if</span> <span class=n>add_sep_token</span><span class=p>:</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tokenizer</span><span class=o>.</span><span class=n>sep_token</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>_tokenizer</span><span class=o>.</span><span class=n>add_special_tokens</span><span class=p>({</span><span class=s2>&quot;sep_token&quot;</span><span class=p>:</span> <span class=s2>&quot;[SEP]&quot;</span><span class=p>})</span>

    <span class=bp>self</span><span class=o>.</span><span class=n>_device</span> <span class=o>=</span> <span class=n>device</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=bocoel.HuggingfaceTokenizer.to class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">to</span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=n>to</span><span class=p>(</span><span class=n>device</span><span class=p>:</span> <span class=n>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n><span title="typing_extensions.Self">Self</span></span>
</code></pre></div> <div class="doc doc-contents "> <p>Move the tokenizer to the given device.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>device</code></td> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The device to move to.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/bocoel/models/lms/huggingface/tokenizers.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span>
<span class=normal>50</span>
<span class=normal>51</span>
<span class=normal>52</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>to</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>device</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=o>/</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Self</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Move the tokenizer to the given device.</span>

<span class=sd>    Parameters:</span>
<span class=sd>        device: The device to move to.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=bp>self</span><span class=o>.</span><span class=n>_device</span> <span class=o>=</span> <span class=n>device</span>
    <span class=k>return</span> <span class=bp>self</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=bocoel.HuggingfaceTokenizer.tokenize class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">tokenize</span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=n>tokenize</span><span class=p>(</span><span class=n>prompts</span><span class=p>:</span> <span class=n><span title="collections.abc.Sequence">Sequence</span></span><span class=p>[</span><span class=n>str</span><span class=p>],</span> <span class=o>/</span><span class=p>,</span> <span class=n>max_length</span><span class=p>:</span> <span class=n>int</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Tokenize, pad, truncate, cast to device, and yield the encoded results. Returning <code>BatchEncoding</code> but not marked in the type hint due to optional dependency.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>prompts</code></td> <td> <code><span title="collections.abc.Sequence">Sequence</span>[str]</code> </td> <td> <div class=doc-md-description> <p>The prompts to tokenize.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code>BatchEncoding</code> </td> <td> <div class=doc-md-description> <p>The tokenized prompts.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/bocoel/models/lms/huggingface/tokenizers.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>54</span>
<span class=normal>55</span>
<span class=normal>56</span>
<span class=normal>57</span>
<span class=normal>58</span>
<span class=normal>59</span>
<span class=normal>60</span>
<span class=normal>61</span>
<span class=normal>62</span>
<span class=normal>63</span>
<span class=normal>64</span>
<span class=normal>65</span>
<span class=normal>66</span>
<span class=normal>67</span>
<span class=normal>68</span>
<span class=normal>69</span>
<span class=normal>70</span>
<span class=normal>71</span>
<span class=normal>72</span>
<span class=normal>73</span>
<span class=normal>74</span>
<span class=normal>75</span>
<span class=normal>76</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>tokenize</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>prompts</span><span class=p>:</span> <span class=n>Sequence</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span> <span class=o>/</span><span class=p>,</span> <span class=n>max_length</span><span class=p>:</span> <span class=nb>int</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Tokenize, pad, truncate, cast to device, and yield the encoded results.</span>
<span class=sd>    Returning `BatchEncoding` but not marked in the type hint</span>
<span class=sd>    due to optional dependency.</span>

<span class=sd>    Parameters:</span>
<span class=sd>        prompts: The prompts to tokenize.</span>

<span class=sd>    Returns:</span>
<span class=sd>        (BatchEncoding): The tokenized prompts.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>prompts</span><span class=p>,</span> <span class=nb>list</span><span class=p>):</span>
        <span class=n>prompts</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>prompts</span><span class=p>)</span>

    <span class=n>inputs</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tokenizer</span><span class=p>(</span>
        <span class=n>prompts</span><span class=p>,</span>
        <span class=n>return_tensors</span><span class=o>=</span><span class=s2>&quot;pt&quot;</span><span class=p>,</span>
        <span class=n>padding</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
        <span class=n>truncation</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
        <span class=n>max_length</span><span class=o>=</span><span class=n>max_length</span><span class=p>,</span>
    <span class=p>)</span>
    <span class=k>return</span> <span class=n>inputs</span><span class=o>.</span><span class=n>to</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>device</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=bocoel.HuggingfaceTokenizer.encode class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">encode</span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=n>encode</span><span class=p>(</span>
    <span class=n>prompts</span><span class=p>:</span> <span class=n><span title="collections.abc.Sequence">Sequence</span></span><span class=p>[</span><span class=n>str</span><span class=p>],</span>
    <span class=o>/</span><span class=p>,</span>
    <span class=n>return_tensors</span><span class=p>:</span> <span class=n>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
    <span class=n>add_special_tokens</span><span class=p>:</span> <span class=n>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
<span class=p>)</span>
</code></pre></div> <div class="doc doc-contents "> <p>Encode the given prompts.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>prompts</code></td> <td> <code><span title="collections.abc.Sequence">Sequence</span>[str]</code> </td> <td> <div class=doc-md-description> <p>The prompts to encode.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr> <td><code>return_tensors</code></td> <td> <code>str | None</code> </td> <td> <div class=doc-md-description> <p>Whether to return tensors.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr> <td><code>add_special_tokens</code></td> <td> <code>bool</code> </td> <td> <div class=doc-md-description> <p>Whether to add special tokens.</p> </div> </td> <td> <code>True</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code><span title="typing.Any">Any</span></code> </td> <td> <div class=doc-md-description> <p>The encoded prompts.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/bocoel/models/lms/huggingface/tokenizers.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>encode</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span>
    <span class=n>prompts</span><span class=p>:</span> <span class=n>Sequence</span><span class=p>[</span><span class=nb>str</span><span class=p>],</span>
    <span class=o>/</span><span class=p>,</span>
    <span class=n>return_tensors</span><span class=p>:</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
    <span class=n>add_special_tokens</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
<span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Encode the given prompts.</span>

<span class=sd>    Parameters:</span>
<span class=sd>        prompts: The prompts to encode.</span>
<span class=sd>        return_tensors: Whether to return tensors.</span>
<span class=sd>        add_special_tokens: Whether to add special tokens.</span>

<span class=sd>    Returns:</span>
<span class=sd>        (Any): The encoded prompts.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tokenizer</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span>
        <span class=n>prompts</span><span class=p>,</span>
        <span class=n>return_tensors</span><span class=o>=</span><span class=n>return_tensors</span><span class=p>,</span>
        <span class=n>add_special_tokens</span><span class=o>=</span><span class=n>add_special_tokens</span><span class=p>,</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=bocoel.HuggingfaceTokenizer.decode class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">decode</span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=n>decode</span><span class=p>(</span><span class=n>outputs</span><span class=p>:</span> <span class=n><span title="typing.Any">Any</span></span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>skip_special_tokens</span><span class=p>:</span> <span class=n>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>str</span>
</code></pre></div> <div class="doc doc-contents "> <p>Decode the given outputs.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>outputs</code></td> <td> <code><span title="typing.Any">Any</span></code> </td> <td> <div class=doc-md-description> <p>The outputs to decode.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr> <td><code>skip_special_tokens</code></td> <td> <code>bool</code> </td> <td> <div class=doc-md-description> <p>Whether to skip special tokens.</p> </div> </td> <td> <code>True</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code>str</code> </td> <td> <div class=doc-md-description> <p>The decoded outputs.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/bocoel/models/lms/huggingface/tokenizers.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>107</span>
<span class=normal>108</span>
<span class=normal>109</span>
<span class=normal>110</span>
<span class=normal>111</span>
<span class=normal>112</span>
<span class=normal>113</span>
<span class=normal>114</span>
<span class=normal>115</span>
<span class=normal>116</span>
<span class=normal>117</span>
<span class=normal>118</span>
<span class=normal>119</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>decode</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>outputs</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>skip_special_tokens</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Decode the given outputs.</span>

<span class=sd>    Parameters:</span>
<span class=sd>        outputs: The outputs to decode.</span>
<span class=sd>        skip_special_tokens: Whether to skip special tokens.</span>

<span class=sd>    Returns:</span>
<span class=sd>        The decoded outputs.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tokenizer</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=n>outputs</span><span class=p>,</span> <span class=n>skip_special_tokens</span><span class=o>=</span><span class=n>skip_special_tokens</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=bocoel.HuggingfaceTokenizer.batch_decode class="doc doc-heading"> <code class="doc-symbol doc-symbol-heading doc-symbol-method"></code> <span class="doc doc-object-name doc-function-name">batch_decode</span> </h3> <div class="doc-signature highlight"><pre><span></span><code><span class=n>batch_decode</span><span class=p>(</span><span class=n>outputs</span><span class=p>:</span> <span class=n><span title="typing.Any">Any</span></span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>skip_special_tokens</span><span class=p>:</span> <span class=n>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>list</span><span class=p>[</span><span class=n>str</span><span class=p>]</span>
</code></pre></div> <div class="doc doc-contents "> <p>Batch decode the given outputs.</p> <p><strong>Parameters:</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>outputs</code></td> <td> <code><span title="typing.Any">Any</span></code> </td> <td> <div class=doc-md-description> <p>The outputs to decode.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr> <td><code>skip_special_tokens</code></td> <td> <code>bool</code> </td> <td> <div class=doc-md-description> <p>Whether to skip special tokens.</p> </div> </td> <td> <code>True</code> </td> </tr> </tbody> </table> <p><strong>Returns:</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td> <code>list[str]</code> </td> <td> <div class=doc-md-description> <p>The batch decoded outputs.</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/bocoel/models/lms/huggingface/tokenizers.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>121</span>
<span class=normal>122</span>
<span class=normal>123</span>
<span class=normal>124</span>
<span class=normal>125</span>
<span class=normal>126</span>
<span class=normal>127</span>
<span class=normal>128</span>
<span class=normal>129</span>
<span class=normal>130</span>
<span class=normal>131</span>
<span class=normal>132</span>
<span class=normal>133</span>
<span class=normal>134</span>
<span class=normal>135</span>
<span class=normal>136</span>
<span class=normal>137</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span> <span class=nf>batch_decode</span><span class=p>(</span>
    <span class=bp>self</span><span class=p>,</span> <span class=n>outputs</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span> <span class=o>/</span><span class=p>,</span> <span class=n>skip_special_tokens</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span>
<span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Batch decode the given outputs.</span>

<span class=sd>    Parameters:</span>
<span class=sd>        outputs: The outputs to decode.</span>
<span class=sd>        skip_special_tokens: Whether to skip special tokens.</span>

<span class=sd>    Returns:</span>
<span class=sd>        The batch decoded outputs.</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_tokenizer</span><span class=o>.</span><span class=n>batch_decode</span><span class=p>(</span>
        <span class=n>outputs</span><span class=p>,</span> <span class=n>skip_special_tokens</span><span class=o>=</span><span class=n>skip_special_tokens</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">August 3, 2024</span> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/rentruewang target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://pypi.org/project/bocoel/ target=_blank rel=noopener title=pypi.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tabs"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.a7c05c9e.min.js></script> <script src=../../javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> </body> </html>